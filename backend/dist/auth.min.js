"use strict";var bcrypt=require("bcryptjs"),users=[],registerUser=function(r,s){var t,a,n,u,c,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.body,a=t.username,n=t.password,u=/^[a-zA-Z0-9]+$/,c=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,a&&n&&u.test(a)&&c.test(n)){e.next=5;break}return e.abrupt("return",s.status(400).json({message:"Invalid username or password."}));case 5:return e.next=7,regeneratorRuntime.awrap(bcrypt.hash(n,12));case 7:return o=e.sent,users.push({username:a,password:o}),e.abrupt("return",s.status(201).json({message:"User registered successfully"}));case 10:case"end":return e.stop()}})};module.exports={registerUser:registerUser};
//# sourceMappingURL=auth.min.js.map
